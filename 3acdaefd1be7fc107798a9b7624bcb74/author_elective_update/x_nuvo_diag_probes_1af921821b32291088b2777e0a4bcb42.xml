<?xml version="1.0" encoding="UTF-8"?><record_update table="x_nuvo_diag_probes">
    <x_nuvo_diag_probes action="DELETE">
        <active>true</active>
        <description>Key Management Framework's Module Access Policies for the recordBuilder SI and recordBuilderMS SI to Result = Reject instead of Result = track.</description>
        <healthcheck_type/>
        <name>Module Access reject Builder</name>
        <order/>
        <probe_type/>
        <product_version>21.1.2</product_version>
        <remediation>Guidance to update the Key Management Framework's Module Access Policies for the recordBuilder SI and recordBuilderMS SI from Result = Reject, to Result = Track. </remediation>
        <script><![CDATA[var util = new x_nuvo_diag.DiagnosticUtil();

var gr = new GlideRecord('sys_kmf_crypto_caller_policy');
//Serch for the sys_id's of the recordBuilder and recordBuilderMS script includes
gr.addEncodedQuery('target_scriptSTARTSWITH884ce9370f5ba600b7fe85ace1050e3d^ORtarget_scriptSTARTSWITH60782d140fbcb240b7fe85ace1050eaf');
gr.addActiveQuery();
gr.query();

//If they exist they will activate the loop.
while (gr.next()) {
	//If their result field is set to reject an error needs to be sent.
	if (gr.result == 'reject') {
		//Check whihc script is throwing the warning
		if (gr.target_script == '884ce9370f5ba600b7fe85ace1050e3d') {
			//if the MS is in error print warning to change the module access control for the MS
			util.handleOutput('The Module Access policy in the Key Managment for the recordBuilderMS script is set to reject please change to track and reset mobile users.' , 'warning','Mobile');
		} else if (gr.target_script == '60782d140fbcb240b7fe85ace1050eaf') {
			//if the base script is in error print warning to change the module access control for it.
			util.handleOutput('The Module Access policy in the Key Managment for the recordBuilder script is set to reject please change to track and reset mobile users.' , 'warning','Mobile');
		}
		
	}
}]]></script>
        <sys_class_name>x_nuvo_diag_probes</sys_class_name>
        <sys_created_by>michael.peck@nuvolo.com</sys_created_by>
        <sys_created_on>2023-05-15 17:50:36</sys_created_on>
        <sys_id>1af921821b32291088b2777e0a4bcb42</sys_id>
        <sys_mod_count>14</sys_mod_count>
        <sys_name>Module Access reject Builder</sys_name>
        <sys_package display_value="Diagnostic Tool" source="x_nuvo_diag">3acdaefd1be7fc107798a9b7624bcb74</sys_package>
        <sys_policy/>
        <sys_scope display_value="Diagnostic Tool">3acdaefd1be7fc107798a9b7624bcb74</sys_scope>
        <sys_update_name>x_nuvo_diag_probes_1af921821b32291088b2777e0a4bcb42</sys_update_name>
        <sys_updated_by>iliyan.nedelchev@nuvolo.com</sys_updated_by>
        <sys_updated_on>2024-12-04 09:40:00</sys_updated_on>
        <tool>diagnostic</tool>
    </x_nuvo_diag_probes>
    <sys_update_version action="INSERT_OR_UPDATE">
        <action>DELETE</action>
        <application display_value="Diagnostic Tool">3acdaefd1be7fc107798a9b7624bcb74</application>
        <file_path/>
        <instance_id>11ac2c71db72ac5052cec5970596197c</instance_id>
        <instance_name>ven04351</instance_name>
        <name>x_nuvo_diag_probes_1af921821b32291088b2777e0a4bcb42</name>
        <payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="x_nuvo_diag_probes"&gt;&lt;x_nuvo_diag_probes action="INSERT_OR_UPDATE"&gt;&lt;active&gt;true&lt;/active&gt;&lt;description&gt;Key Management Framework's Module Access Policies for the recordBuilder SI and recordBuilderMS SI to Result = Reject instead of Result = track.&lt;/description&gt;&lt;healthcheck_type/&gt;&lt;name&gt;Module Access reject Builder&lt;/name&gt;&lt;order/&gt;&lt;probe_type/&gt;&lt;product_version&gt;21.1.2&lt;/product_version&gt;&lt;remediation&gt;Guidance to update the Key Management Framework's Module Access Policies for the recordBuilder SI and recordBuilderMS SI from Result = Reject, to Result = Track. &lt;/remediation&gt;&lt;script&gt;&lt;![CDATA[var util = new x_nuvo_diag.DiagnosticUtil();

var gr = new GlideRecord('sys_kmf_crypto_caller_policy');
//Serch for the sys_id's of the recordBuilder and recordBuilderMS script includes
gr.addEncodedQuery('target_scriptSTARTSWITH884ce9370f5ba600b7fe85ace1050e3d^ORtarget_scriptSTARTSWITH60782d140fbcb240b7fe85ace1050eaf');
gr.addActiveQuery();
gr.query();

//If they exist they will activate the loop.
while (gr.next()) {
	//If their result field is set to reject an error needs to be sent.
	if (gr.result == 'reject') {
		//Check whihc script is throwing the warning
		if (gr.target_script == '884ce9370f5ba600b7fe85ace1050e3d') {
			//if the MS is in error print warning to change the module access control for the MS
			util.handleOutput('The Module Access policy in the Key Managment for the recordBuilderMS script is set to reject please change to track and reset mobile users.' , 'warning','Mobile');
		} else if (gr.target_script == '60782d140fbcb240b7fe85ace1050eaf') {
			//if the base script is in error print warning to change the module access control for it.
			util.handleOutput('The Module Access policy in the Key Managment for the recordBuilder script is set to reject please change to track and reset mobile users.' , 'warning','Mobile');
		}
		
	}
}]]&gt;&lt;/script&gt;&lt;sys_class_name&gt;x_nuvo_diag_probes&lt;/sys_class_name&gt;&lt;sys_created_by&gt;michael.peck@nuvolo.com&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2023-05-15 17:50:36&lt;/sys_created_on&gt;&lt;sys_id&gt;1af921821b32291088b2777e0a4bcb42&lt;/sys_id&gt;&lt;sys_mod_count&gt;14&lt;/sys_mod_count&gt;&lt;sys_name&gt;Module Access reject Builder&lt;/sys_name&gt;&lt;sys_package display_value="Diagnostic Tool" source="x_nuvo_diag"&gt;3acdaefd1be7fc107798a9b7624bcb74&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_scope display_value="Diagnostic Tool"&gt;3acdaefd1be7fc107798a9b7624bcb74&lt;/sys_scope&gt;&lt;sys_update_name&gt;x_nuvo_diag_probes_1af921821b32291088b2777e0a4bcb42&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;iliyan.nedelchev@nuvolo.com&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2024-12-04 09:40:00&lt;/sys_updated_on&gt;&lt;tool&gt;diagnostic&lt;/tool&gt;&lt;/x_nuvo_diag_probes&gt;&lt;/record_update&gt;</payload>
        <payload_hash>860228031</payload_hash>
        <record_name>Module Access reject Builder</record_name>
        <reverted_from/>
        <source>7cdf88c6db0620106f7d1cbd139619a7</source>
        <source_table>sys_update_set</source_table>
        <state>previous</state>
        <sys_created_by>system</sys_created_by>
        <sys_created_on>2025-09-01 15:13:05</sys_created_on>
        <sys_id>71cd7e9c477722106d8ba835126d43a8</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_recorded_at>19905d6c6490000001</sys_recorded_at>
        <sys_updated_by>system</sys_updated_by>
        <sys_updated_on>2025-09-01 15:13:05</sys_updated_on>
        <type>Probes</type>
        <update_guid>b9cd7e9cff772210a8ac95c865359ca7</update_guid>
        <update_guid_history>b9cd7e9cff772210a8ac95c865359ca7:0,365496d5f7f8e21097003e3c75430665:0,54ba8285b8de9e106e7746183347c131:182431297,65e5348c37f412501479d4d2f8487e79:1017734668,a1e5348c2ef4125082df706aedef9d78:-702525237</update_guid_history>
    </sys_update_version>
    <sys_metadata_delete action="INSERT_OR_UPDATE">
        <sys_audit_delete display_value="Module Access reject Builder">9ca38b1447b722106d8ba835126d438d</sys_audit_delete>
        <sys_class_name>sys_metadata_delete</sys_class_name>
        <sys_created_by>iliyan.nedelchev@nuvolo.com</sys_created_by>
        <sys_created_on>2025-09-01 15:38:39</sys_created_on>
        <sys_db_object display_value="" name="x_nuvo_diag_probes">x_nuvo_diag_probes</sys_db_object>
        <sys_id>64e2d77b1c9b4000894373bb88400000</sys_id>
        <sys_metadata>1af921821b32291088b2777e0a4bcb42</sys_metadata>
        <sys_mod_count>0</sys_mod_count>
        <sys_name>Module Access reject Builder</sys_name>
        <sys_package display_value="Diagnostic Tool" source="x_nuvo_diag">3acdaefd1be7fc107798a9b7624bcb74</sys_package>
        <sys_parent/>
        <sys_policy/>
        <sys_scope display_value="Diagnostic Tool">3acdaefd1be7fc107798a9b7624bcb74</sys_scope>
        <sys_scope_delete display_value="">241d85aa10a64a40ba89630d1fbfb900</sys_scope_delete>
        <sys_update_name>x_nuvo_diag_probes_1af921821b32291088b2777e0a4bcb42</sys_update_name>
        <sys_update_version display_value="x_nuvo_diag_probes_1af921821b32291088b2777e0a4bcb42">71cd7e9c477722106d8ba835126d43a8</sys_update_version>
        <sys_updated_by>iliyan.nedelchev@nuvolo.com</sys_updated_by>
        <sys_updated_on>2025-09-01 15:38:39</sys_updated_on>
    </sys_metadata_delete>
</record_update>
